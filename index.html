<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBDown‰ªªÂä°ÁÆ°ÁêÜÂô®</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="bbdown_icon.svg" type="image/svg+xml">
</head>
<body>
    <div class="container">
        <!-- È°∂ÈÉ®ËøûÊé•ÊéßÂà∂Ê†è -->
        <div class="connection-controls">
            <div class="connection-group">
                <h3>ËøûÊé•ËÆæÁΩÆ</h3>
                <div class="connection-form">
                    <label>‰∏ªÊú∫:</label>
                    <input type="text" id="host-input" value="localhost" placeholder="localhost">
                    <label>Á´ØÂè£:</label>
                    <input type="number" id="port-input" value="58682" placeholder="58682">
                    <button id="connect-btn" class="btn btn-primary">
                        <span class="icon">üîó</span> ËøûÊé•
                    </button>
                    <div class="connection-status" id="connection-status">
                        <span class="status-indicator offline"></span>
                        <span class="status-text">Êú™ËøûÊé•</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÈÄâÈ°πÂç°ÂÆπÂô® -->
        <div class="tabs-container">
            <div class="tab-headers">
                <button class="tab-header active" data-tab="dashboard">‰ªªÂä°‰ª™Ë°®Áõò</button>
                <button class="tab-header" data-tab="add-task">Ê∑ªÂä†‰ªªÂä°</button>
                <button class="tab-header" data-tab="manage">‰ªªÂä°ÁÆ°ÁêÜ</button>
            </div>

            <!-- ‰ªªÂä°‰ª™Ë°®Áõò -->
            <div class="tab-content active" id="dashboard">
                <div class="dashboard-controls">
                    <button id="refresh-btn" class="btn btn-secondary">
                        <span class="icon">üîÑ</span> Âà∑Êñ∞‰ªªÂä°
                    </button>
                    <div class="auto-refresh">
                        <label>
                            <input type="checkbox" id="auto-refresh" checked>
                            Ëá™Âä®Âà∑Êñ∞ (10Áßí)
                        </label>
                    </div>
                </div>

                <div class="tasks-container">
                    <div class="task-section">
                        <h3>ËøêË°å‰∏≠‰ªªÂä°</h3>
                        <div class="table-container">
                            <table id="running-tasks-table" class="task-table">
                                <thead>
                                    <tr>
                                        <th>AID</th>
                                        <th>Ê†áÈ¢ò</th>
                                        <th>ÂàõÂª∫Êó∂Èó¥</th>
                                        <th>ËøõÂ∫¶</th>
                                        <th>ÈÄüÂ∫¶</th>
                                        <th>Â§ßÂ∞è</th>
                                        <th>Áä∂ÊÄÅ</th>
                                        <th>Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div class="empty-state" id="running-empty">
                                <span class="icon">üìã</span>
                                <p>ÊöÇÊó†ËøêË°å‰∏≠ÁöÑ‰ªªÂä°</p>
                            </div>
                        </div>
                    </div>

                    <div class="task-section">
                        <h3>Â∑≤ÂÆåÊàê‰ªªÂä°</h3>
                        <div class="table-container">
                            <table id="finished-tasks-table" class="task-table">
                                <thead>
                                    <tr>
                                        <th>AID</th>
                                        <th>Ê†áÈ¢ò</th>
                                        <th>ÂàõÂª∫Êó∂Èó¥</th>
                                        <th>ÂÆåÊàêÊó∂Èó¥</th>
                                        <th>ËøõÂ∫¶</th>
                                        <th>Â§ßÂ∞è</th>
                                        <th>Áä∂ÊÄÅ</th>
                                        <th>Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div class="empty-state" id="finished-empty">
                                <span class="icon">‚úÖ</span>
                                <p>ÊöÇÊó†Â∑≤ÂÆåÊàêÁöÑ‰ªªÂä°</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê∑ªÂä†‰ªªÂä° -->
            <div class="tab-content" id="add-task">
                <div class="options-form">
                    <!-- Âü∫Êú¨ÈÄâÈ°π -->
                    <div class="option-group">
                        <div class="group-header" data-group="basic">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>Âü∫Êú¨ÈÄâÈ°π</h3>
                        </div>
                        <div class="group-content" id="basic-options">
                            <div class="form-row">
                                <label for="url-input">ËßÜÈ¢ëURL:</label>
                                <input type="text" id="url-input" placeholder="ËæìÂÖ•BV/av/ep/ssÂè∑ÊàñËßÜÈ¢ëURL" required>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="only-show-info">
                                    ‰ªÖÊòæÁ§∫‰ø°ÊÅØÔºà‰∏ç‰∏ãËΩΩÔºâ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="show-all">
                                    ÊòæÁ§∫ÊâÄÊúâ‰ø°ÊÅØÔºàÂåÖÊã¨ÈöêËóèÊµÅÔºâ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="interactive">
                                    ‰∫§‰∫íÊ®°ÂºèÔºàÊâãÂä®ÈÄâÊã©Ôºâ
                                </label>
                            </div>
                            <div class="form-row">
                                <label for="area-select">Âå∫ÂüüËÆæÁΩÆ:</label>
                                <select id="area-select">
                                    <option value="">ÈªòËÆ§</option>
                                    <option value="Â§ßÈôÜ">Â§ßÈôÜ</option>
                                    <option value="Ê∏ØÊæ≥Âè∞">Ê∏ØÊæ≥Âè∞</option>
                                    <option value="Ê≥∞ÂõΩ">Ê≥∞ÂõΩ</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                            </div>
                            <div class="form-row">
                                <label for="language-input">ËØ≠Ë®Ä:</label>
                                <input type="text" id="language-input" placeholder="Â¶Ç: zh-Hans">
                            </div>
                            <div class="form-row">
                                <label for="delay-input">ÂàÜÈ°µÂª∂Ëøü(ms):</label>
                                <input type="number" id="delay-input" value="0" min="0" max="10000">
                            </div>
                        </div>
                    </div>

                    <!-- APIÈÄâÈ°π -->
                    <div class="option-group">
                        <div class="group-header" data-group="api">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>APIÈÄâÈ°π</h3>
                        </div>
                        <div class="group-content" id="api-options">
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="api-type" id="api-tv" value="tv">
                                    ‰ΩøÁî®TV API
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="api-type" id="api-app" value="app">
                                    ‰ΩøÁî®App API
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="api-type" id="api-intl" value="intl">
                                    ‰ΩøÁî®ÂõΩÈôÖÁâàAPI
                                </label>
                            </div>
                            <div class="form-row">
                                <label for="tv-host-input">TV API‰∏ªÊú∫:</label>
                                <input type="text" id="tv-host-input" value="api.snm0516.aisee.tv">
                            </div>
                        </div>
                    </div>

                    <!-- ÂÜÖÂÆπÈÄâÊã© -->
                    <div class="option-group">
                        <div class="group-header" data-group="content">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>ÂÜÖÂÆπÈÄâÊã©</h3>
                        </div>
                        <div class="group-content" id="content-options">
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="content-type" id="video-only" value="video">
                                    ‰ªÖ‰∏ãËΩΩËßÜÈ¢ë
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="content-type" id="audio-only" value="audio">
                                    ‰ªÖ‰∏ãËΩΩÈü≥È¢ë
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="danmaku-only">
                                    ‰ªÖ‰∏ãËΩΩÂºπÂπï
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="cover-only">
                                    ‰ªÖ‰∏ãËΩΩÂ∞ÅÈù¢
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="sub-only">
                                    ‰ªÖ‰∏ãËΩΩÂ≠óÂπï
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="download-danmaku">
                                    ‰∏ãËΩΩÂºπÂπï
                                </label>
                            </div>
                            <div class="form-row">
                                <label for="danmaku-formats">ÂºπÂπïÊ†ºÂºè:</label>
                                <input type="text" id="danmaku-formats" placeholder="Â¶Ç: xml,ass Áî®ÈÄóÂè∑ÂàÜÈöî">
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="skip-ai" checked>
                                    Ë∑≥ËøáAIÁîüÊàêÂ≠óÂπï
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ‰∏ãËΩΩÊéßÂà∂ -->
                    <div class="option-group">
                        <div class="group-header" data-group="control">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>‰∏ãËΩΩÊéßÂà∂</h3>
                        </div>
                        <div class="group-content" id="control-options">
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="multi-thread" checked>
                                    Â§öÁ∫øÁ®ã‰∏ãËΩΩ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="use-mp4box">
                                    ‰ΩøÁî®MP4boxÂ∞ÅË£Ö
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="use-aria2c">
                                    ‰ΩøÁî®aria2c‰∏ãËΩΩ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="simply-mux">
                                    ÁÆÄÂçïÊ∑∑ÊµÅÔºàÂáèÂ∞ëÂ§ÑÁêÜÔºâ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="skip-mux">
                                    Ë∑≥ËøáÊ∑∑ÊµÅÊ≠•È™§
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="skip-subtitle">
                                    Ë∑≥ËøáÂ≠óÂπï‰∏ãËΩΩ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="skip-cover">
                                    Ë∑≥ËøáÂ∞ÅÈù¢‰∏ãËΩΩ
                                </label>
                            </div>
                            <div class="form-row">
                                <label for="encoding-priority">ÁºñÁ†Å‰ºòÂÖàÁ∫ß:</label>
                                <input type="text" id="encoding-priority" placeholder="Â¶Ç: hevc,av1,avc">
                            </div>
                            <div class="form-row">
                                <label for="dfn-priority">ÁîªË¥®‰ºòÂÖàÁ∫ß:</label>
                                <input type="text" id="dfn-priority" placeholder="Â¶Ç: 1080p,720p">
                            </div>
                            <div class="form-row">
                                <label for="select-page">ÂàÜÈ°µÈÄâÊã©:</label>
                                <input type="text" id="select-page" placeholder="Â¶Ç: 1-5,8">
                            </div>
                        </div>
                    </div>

                    <!-- Êñá‰ª∂ÂëΩÂêç -->
                    <div class="option-group">
                        <div class="group-header" data-group="file">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>Êñá‰ª∂ÂëΩÂêç</h3>
                        </div>
                        <div class="group-content" id="file-options">
                            <div class="form-row">
                                <label for="file-pattern">Êñá‰ª∂ÂëΩÂêçÊ®°Âºè:</label>
                                <input type="text" id="file-pattern" placeholder="Â¶Ç: <videoTitle>[<dfn>]">
                            </div>
                            <div class="form-row">
                                <label for="multi-file-pattern">Â§öPÊñá‰ª∂ÂëΩÂêç:</label>
                                <input type="text" id="multi-file-pattern" placeholder="Â¶Ç: P<pageNumber>_<videoTitle>">
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="add-dfn-subfix">
                                    Ê∑ªÂä†ÁîªË¥®ÂêéÁºÄ
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="no-padding-page">
                                    ‰∏çË°•ÈΩêÈ°µÁ†Å‰ΩçÊï∞
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Ë∑ØÂæÑËÆæÁΩÆ -->
                    <div class="option-group">
                        <div class="group-header" data-group="path">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>Ë∑ØÂæÑËÆæÁΩÆ</h3>
                        </div>
                        <div class="group-content" id="path-options">
                            <div class="form-row">
                                <label for="work-dir">Â∑•‰ΩúÁõÆÂΩï:</label>
                                <input type="text" id="work-dir" placeholder="‰∏ãËΩΩÊñá‰ª∂‰øùÂ≠òË∑ØÂæÑ">
                            </div>
                            <div class="form-row">
                                <label for="ffmpeg-path">FFmpegË∑ØÂæÑ:</label>
                                <input type="text" id="ffmpeg-path" placeholder="FFmpegÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑ">
                            </div>
                            <div class="form-row">
                                <label for="mp4box-path">MP4boxË∑ØÂæÑ:</label>
                                <input type="text" id="mp4box-path" placeholder="MP4boxÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑ">
                            </div>
                            <div class="form-row">
                                <label for="aria2c-path">Aria2cË∑ØÂæÑ:</label>
                                <input type="text" id="aria2c-path" placeholder="Aria2cÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑ">
                            </div>
                        </div>
                    </div>

                    <!-- ÁΩëÁªúËÆæÁΩÆ -->
                    <div class="option-group">
                        <div class="group-header" data-group="network">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>ÁΩëÁªúËÆæÁΩÆ</h3>
                        </div>
                        <div class="group-content" id="network-options">
                            <div class="form-row">
                                <label for="user-agent">User Agent:</label>
                                <input type="text" id="user-agent" placeholder="Ëá™ÂÆö‰πâUser Agent">
                            </div>
                            <div class="form-row">
                                <label for="cookie">Cookie:</label>
                                <input type="text" id="cookie" placeholder="ÁôªÂΩïCookie">
                            </div>
                            <div class="form-row">
                                <label for="access-token">Access Token:</label>
                                <input type="text" id="access-token" placeholder="ËÆøÈóÆ‰ª§Áâå">
                            </div>
                            <div class="form-row">
                                <label for="host-input-network">‰∏ªÊú∫:</label>
                                <input type="text" id="host-input-network" placeholder="Ëá™ÂÆö‰πâ‰∏ªÊú∫">
                            </div>
                            <div class="form-row">
                                <label for="ep-host-input">EP‰∏ªÊú∫:</label>
                                <input type="text" id="ep-host-input" placeholder="EP API‰∏ªÊú∫">
                            </div>
                            <div class="form-row">
                                <label for="upos-host">UPOS‰∏ªÊú∫:</label>
                                <input type="text" id="upos-host" placeholder="UPOS‰∏ªÊú∫">
                            </div>
                            <div class="form-row">
                                <label for="aria2c-args">Aria2cÂèÇÊï∞:</label>
                                <input type="text" id="aria2c-args" placeholder="È¢ùÂ§ñÁöÑAria2cÂèÇÊï∞">
                            </div>
                            <div class="form-row">
                                <label for="aria2c-proxy">Aria2c‰ª£ÁêÜ:</label>
                                <input type="text" id="aria2c-proxy" placeholder="‰ª£ÁêÜËÆæÁΩÆ">
                            </div>
                        </div>
                    </div>

                    <!-- È´òÁ∫ßËÆæÁΩÆ -->
                    <div class="option-group">
                        <div class="group-header" data-group="advanced">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>È´òÁ∫ßËÆæÁΩÆ</h3>
                        </div>
                        <div class="group-content" id="advanced-options">
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="debug">
                                    Ë∞ÉËØïÊ®°Âºè
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="force-http">
                                    Âº∫Âà∂‰ΩøÁî®HTTP
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="allow-pcdn">
                                    ÂÖÅËÆ∏PCDN
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="force-replace-host">
                                    Âº∫Âà∂ÊõøÊç¢‰∏ªÊú∫
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="save-archives">
                                    ‰øùÂ≠òÂΩíÊ°£Âà∞Êñá‰ª∂
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="video-asc">
                                    ËßÜÈ¢ëÂçáÂ∫èÊéíÂàó
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="audio-asc">
                                    Èü≥È¢ëÂçáÂ∫èÊéíÂàó
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="checkbox" id="bandwidth-asc">
                                    Â∏¶ÂÆΩÂçáÂ∫èÊéíÂàó
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ÂÖºÂÆπÊÄßÈÄâÈ°π -->
                    <div class="option-group">
                        <div class="group-header" data-group="compat">
                            <span class="toggle-icon">‚ñ∂</span>
                            <h3>ÂÖºÂÆπÊÄßÈÄâÈ°π</h3>
                        </div>
                        <div class="group-content" id="compat-options">
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="codec-type" id="only-hevc" value="hevc">
                                    ‰ªÖHEVCÁºñÁ†Å
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="codec-type" id="only-avc" value="avc">
                                    ‰ªÖAVCÁºñÁ†Å
                                </label>
                            </div>
                            <div class="form-row">
                                <label>
                                    <input type="radio" name="codec-type" id="only-av1" value="av1">
                                    ‰ªÖAV1ÁºñÁ†Å
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="add-task-controls">
                    <button id="add-task-btn" class="btn btn-primary btn-large">
                        <span class="icon">‚ûï</span> Ê∑ªÂä†‰ªªÂä°
                    </button>
                </div>
            </div>

            <!-- ‰ªªÂä°ÁÆ°ÁêÜ -->
            <div class="tab-content" id="manage">
                <div class="manage-controls">
                    <div class="batch-operations">
                        <h3>ÊâπÈáèÊìç‰Ωú</h3>
                        <div class="button-group">
                            <button id="remove-all-btn" class="btn btn-danger">
                                <span class="icon">üóëÔ∏è</span> ÁßªÈô§ÊâÄÊúâÂ∑≤ÂÆåÊàê‰ªªÂä°
                            </button>
                            <button id="remove-failed-btn" class="btn btn-warning">
                                <span class="icon">‚ö†Ô∏è</span> ÁßªÈô§ÊâÄÊúâÂ§±Ë¥•‰ªªÂä°
                            </button>
                        </div>
                    </div>

                    <div class="single-operation">
                        <h3>ÊåâAIDÁßªÈô§</h3>
                        <div class="aid-form">
                            <input type="text" id="aid-input" placeholder="ËæìÂÖ•Ë¶ÅÁßªÈô§ÁöÑ‰ªªÂä°AID">
                            <button id="remove-by-aid-btn" class="btn btn-danger">
                                <span class="icon">üóëÔ∏è</span> ÁßªÈô§‰ªªÂä°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰ªªÂä°ËØ¶ÊÉÖÊ®°ÊÄÅÊ°Ü -->
    <div id="task-detail-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‰ªªÂä°ËØ¶ÊÉÖ</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="task-detail-content">
                <!-- ‰ªªÂä°ËØ¶ÊÉÖÂÜÖÂÆπÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÂ°´ÂÖÖ -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary modal-close">ÂÖ≥Èó≠</button>
            </div>
        </div>
    </div>

    <!-- Âä†ËΩΩÊåáÁ§∫Âô® -->
    <div id="loading-indicator" class="loading">
        <div class="spinner"></div>
        <p>Ê≠£Âú®Â§ÑÁêÜ...</p>
    </div>

    <!-- ÈÄöÁü•ÂÆπÂô® -->
    <div id="notification-container"></div>

    <script src="script.js"></script>
</body>
</html>